# Documentation Portal Guide (Static `/docs`)

**Last Updated**: January 3, 2026

This guide explains how the **static documentation portal** under **`/docs`** is built, why it’s structured the way it is, how it stays up-to-date, and how to extend it safely (including future additions like JSDoc/TypeDoc).

It is written to be:

- **Specific to this repo** (with direct links to implementation files)
- **Abstract enough** to apply to any ICJIA (or similar) site using **Nuxt + Vuetify + Netlify**

---

## Goals

- **Zero-app-coupling**: Docs should be available even if the SPA changes.
- **Static + fast**: Serve docs as plain static HTML files (CDN-friendly).
- **Accessible by default**: No JS required; strong focus styles; proper landmarks/labels.
- **Up-to-date**: Build scripts regenerate key docs (architecture, accessibility report, PDFs, etc.).
- **Easy to extend**: Add new sections by dropping in `public/docs/<section>/index.html` and linking it.

---

## High-level Architecture

### What `/docs` is (and is not)

- `/docs` is **not a Nuxt route** in this project.
- It is a **static documentation portal** located in the `public/` directory and served as static assets.

**Source-of-truth location:**

- Portal entry point: `public/docs/index.html`
- Portal sections:
  - `public/docs/architecture/index.html`
  - `public/docs/accessibility/index.html`
  - `public/docs/tests/index.html`

Repo links:

- Portal index: [`public/docs/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/index.html)
- Architecture doc output: [`public/docs/architecture/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/architecture/index.html)
- Accessibility report output: [`public/docs/accessibility/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/accessibility/index.html)
- Tests report output: [`public/docs/tests/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/tests/index.html)
- JSDoc/TypeDoc API documentation: [`public/docs/jsdoc/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/jsdoc/index.html)

---

## File Layout & Conventions

### Folder structure

```
public/
  docs/
    index.html                 # Portal "home"
    architecture/index.html    # Generated from ARCHITECTURE_GUIDE.md
    accessibility/index.html   # Generated by the axe-core audit script (or placeholder)
    tests/index.html           # Generated by test reporting scripts
    jsdoc/index.html           # Generated by TypeDoc from JSDoc comments
```

### URL conventions

For static hosting (Netlify, nginx, etc.) directory URLs usually map to `index.html`:

- `/docs/` → `/docs/index.html`
- `/docs/architecture/` → `/docs/architecture/index.html`

**Build-time prerendering caveat (Nuxt generate):**

- Some prerender crawlers treat `/docs/` as an app route and may 404.
- When linking from app-rendered pages, prefer **`/docs/index.html`** (explicit file) to avoid prerender failures.

Implementation example:

- Footer uses the explicit file URL: [`app/components/AppFooter.vue`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/app/components/AppFooter.vue)

---

## How the Portal is Built

### 1) Portal index (`public/docs/index.html`)

The portal homepage is a hand-authored static HTML page:

- Uses a simple **card grid** layout linking to documentation sections.
- Includes focus-visible styles for keyboard users.

Implementation:

- [`public/docs/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/index.html)

To add a new card:

1. Add a new section folder under `public/docs/<new-section>/index.html`
2. Add a new `<a class="doc-card" href="/docs/<new-section>">…</a>` entry in `public/docs/index.html`

---

### 2) Architecture docs generation (`/docs/architecture`)

Architecture docs are authored in markdown and converted to static HTML during development/build:

- Markdown source: [`markdown-documentation/ARCHITECTURE_GUIDE.md`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/markdown-documentation/ARCHITECTURE_GUIDE.md)
- Generator script: [`scripts/generate-architecture-docs.js`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/scripts/generate-architecture-docs.js)
- Output: `public/docs/architecture/index.html`

Run it manually:

```bash
yarn generate:docs
```

**Extending this pattern**:

- Add `scripts/generate-<topic>-docs.js` that writes to `public/docs/<topic>/index.html`
- Add a portal card in `public/docs/index.html`

---

### 3) Accessibility report (`/docs/accessibility`)

The accessibility report is generated by an axe-core + Playwright script:

- Generator: [`audit-accessibility.js`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/audit-accessibility.js)
- Output dir: `public/docs/accessibility/`

To ensure `/docs/accessibility` never 404s, we create a placeholder report if missing:

- Script: [`scripts/ensure-accessibility-report.js`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/scripts/ensure-accessibility-report.js)
- Nuxt plugin also ensures copying/availability during builds:
  - [`app/plugins/ensure-accessibility-report.server.ts`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/app/plugins/ensure-accessibility-report.server.ts)

Run the audit:

```bash
yarn audit:a11y
```

---

### 4) Test report (`/docs/tests`)

The test report is emitted into:

- `public/docs/tests/index.html`

Docs:

- Test reporting overview: [`test/REPORTING.md`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/test/REPORTING.md)
- Test runner: [`test/run-all-tests.js`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/test/run-all-tests.js)

---

## How the Portal is Served (Dev vs Build)

### Local dev (`yarn dev`)

Nuxt serves everything in `public/` as static assets.

So:

- `/docs/index.html` works
- `/docs/architecture` works (as a static directory with `index.html`)

### Static build (`yarn generate` / Netlify)

Nuxt’s static output goes to `.output/public`.

Static files from `public/` are copied into `.output/public` as part of the generate process. This means:

- The docs portal ships automatically as part of the deployment.

Build configuration:

- Netlify config: [`netlify.toml`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/netlify.toml)
- Nuxt config: [`nuxt.config.ts`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/nuxt.config.ts)

---

## Netlify + Nuxt/Vuetify “Rules of the Road”

### 1) Static docs should stay static

- Keep docs under `public/docs/...`
- Avoid turning docs into Nuxt pages unless you need runtime behavior.

### 2) Prerender crawler behavior

During `nuxt generate`, Nitro crawls links it finds.

If your app links to `/docs/` (directory URL), some builds can treat it as a missing app route and fail.

**Best practice:**

- Prefer linking to **`/docs/index.html`** from the SPA (it’s unambiguously a static file).

### 3) Playwright install on Netlify (CI)

If you generate PDFs at build time using Playwright/Chromium:

- **Do not use** `--with-deps` on Netlify (it attempts root escalation).
- Use:

```toml
[build]
  command = "npx playwright install chromium && yarn generate"
  publish = ".output/public"
```

Repo reference:

- [`netlify.toml`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/netlify.toml)

---

## Adding New Sections (Future-proofing)

### Option A: Add a hand-authored static section

1. Create `public/docs/<topic>/index.html`
2. Add a new card to `public/docs/index.html`
3. (Optional) Add a link in the app footer to `/docs/index.html`

### Option B: Add a generated section (recommended for maintainability)

Use a markdown source file in `markdown-documentation/` and generate HTML into `public/docs/<topic>/`.

Example pattern:

- Input: `markdown-documentation/<TOPIC>.md`
- Generator: `scripts/generate-<topic>-docs.js`
- Output: `public/docs/<topic>/index.html`

Then wire it into your build:

- Add a `package.json` script (e.g. `generate:<topic>`)
- Run it in `predev`, `prebuild`, or a dedicated docs pipeline

---

## JSDoc / TypeDoc API Documentation ✅ IMPLEMENTED

The API documentation is generated using TypeDoc with JSDoc comments.

### Location

- **Output**: `public/docs/jsdoc/`
- **URL**: `/docs/jsdoc/`

### Covered Files

- **Composables** (6 files): `useDeadlineCountdown`, `useFaqCollapse`, `usePrintLinks`, `useSeo`, `useSlugify`, `useStructuredData`
- **Utilities** (1 file): `faqTransform.ts`
- **Plugins** (7 files): All client and server plugins

### Generation

Run manually:

```bash
yarn generate:jsdoc
```

Or automatically during static site generation (`yarn generate`).

### Configuration

Configuration file: [`typedoc.json`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/typedoc.json)

Features:
- Source links to GitHub
- Full function/interface documentation
- Type definitions
- Code examples

---

## Accessibility Tips (Docs Portal)

Because docs are static HTML, you can make them highly accessible with simple rules:

- **Page language**: `<html lang="en">`
- **Single H1**: One `<h1>` per page
- **Focusable cards/links**: use `<a>` for clickable cards; ensure `:focus-visible` styles
- **Descriptive link text**: avoid “Click here”; use “View Architecture Guide →”
- **Color contrast**: meet WCAG AA contrast (especially for muted text)
- **No hover-only cues**: ensure keyboard users see a clear focus ring
- **Keyboard navigation**: don’t trap focus; no JS required
- **Prefer reduced motion**: avoid animated transitions that can be disorienting; if you use them, keep them subtle

Reference examples:

- Focus styles on portal cards: [`public/docs/index.html`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/public/docs/index.html)
- Accessibility report placeholder includes semantic basics: [`scripts/ensure-accessibility-report.js`](https://github.com/ICJIA/icjia-accessibility-portal/blob/main/scripts/ensure-accessibility-report.js)

---

## Maintenance Checklist

When you add or change documentation:

- **Add/update portal links**: `public/docs/index.html`
- **Regenerate generated docs** (if applicable): `yarn generate:docs`, `yarn audit:a11y`, test scripts, etc.
- **Verify locally**:
  - `yarn dev` → open `/docs/index.html`
  - `yarn generate:serve` → open `/docs/index.html` and confirm content is present
- **Netlify**:
  - Ensure build command installs Playwright Chromium if PDF generation is enabled
  - Confirm deploy output contains `docs/` and any new section folders
